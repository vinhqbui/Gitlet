# Gitlet Design Document

**Name**:

## Classes and Data Structures
**Blob**: Store *content*, *title*, and *hash ID* of a file.

- ***content***: content of the file.
- ***title***: name of the file.
- ***hash ID***: file with different filename or content will treat as different file.

**Commit**: will be used to store commits metadata.
- ***commit id***: the id of commit.
- ***date***: the time that the commit was made.
- ***author***: the author of commit.
- ***message***: the message of the commit.
- ***blobs***: The Hashmap (key is file name) of blob ids of files was changed in the commits.
- ***parent_origin***: the parent commit id.
- ***merge_parent***: the parent commit id that was merged into this commit.

**Branch**: the branch metadata.
- ***name***: name of branch and this should be **unique**.
- ***commit***: store the latest commit id of the branch.
- ***_defaultFolder***: universal defaults folder for branch. All the branches files will be stored in "branches" folder.

**Gitlet**: main class control the Gitlet behavior. The class
manage 5 zones: staged, removed, modification, untracked and branches.
- **init**: Create _.gitlet_ folder
- **add**: add _untracked_ files into staging zone.
- ***rm***: move files from staged into ready-to-remove zone, if in modifications, move to removed. DO NOT REMOVE UNLESS FILES ARE TRACKED.
If they are tracked, remove them.
- **status**: get status of current Gitlet folder. Output 5 sections.
- **commit**: save a snapshot of tracked files in current commits and update content of staged files. Clear staging areas.
Commit command will not add, remove, or change files.
- **checkout**: there are three functionalities: move to different branch, retrieve a backup copy of a files, or checkout a file within a commit.
- **log**: show the commits history of the current branch.

## Algorithms
**Blob**: the hash id will be generated by hash(title + content)
This hash id will be its file name in the folder.

**Commit**: the commit id will be generated by hash(timestamp + author + message).

When a commit is made within a branch, there are two steps:
1. The branch will set the latest commit to the newly generated commit and store itself.
2. Also, trigger the commit saving process. The process includes saving the staged files into blobs
and backup itself.
3. Newly generated commit will track all the files that previous commit track and additional files (as needed).

**Branch creating**: when creating a branch, new branch will make a copy of the current branch
and change to the new name. The HEAD is the current branch.

**Branch switching**: update the HEAD into the given branch.

**Checkout file of the latest commit**: check if the latest commit has the clone of the file, 
if it has, restore it if it is safe to do so.

**Checkout file of a given commit**: check if a given commit tracked the file.
If it does, restore it if it is safe to do so.



## Persistence
**Init**: will create .gitlet folder if not done so. Otherwise, print
"_Gitlet version-control system already exists in the current directory._"
Create ***master*** branch and an initial commit with timestamp 0.
- .gitlet: the master folder that contain the files need for gitlet to work.
- branches folder: the folder that stores the branches information.
- commits folder: store the information of commit files.
- blobs folder: store the clones of the files.
- gitlet instance: the serialized file store the gitlet instance.

### Information Retrieving
Functions like **log**, **global-log**, **find**, **status** does not save the state of the gitlet because they do not change anything.

### Storing Files
Gitlet, Blobs and commits objects will be stored by serialization after gitlet finishes running
any command. Gitlet will save itself, any blobs and commits along with it.